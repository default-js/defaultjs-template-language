!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=5)}([function(t,e,n){"use strict";n.r(e),function(t){const n={global:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},globalVar:function(t,e){return 2===arguments.length&&void 0===n.global[t]&&(n.global[t]=e),n.global[t]}};e.default=n}.call(this,n(2))},function(t,e,n){"use strict";n.r(e),function(t){const n=void 0!==t?t:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{};e.default=n}.call(this,n(2))},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";n.r(e),function(t){const n=void 0!==t?t:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{};e.default=n}.call(this,n(2))},function(t,e){String.prototype.hashcode||(String.prototype.hashcode=function(){if(0===this.length)return 0;let t=0;const e=this.length;for(let n=0;n<e;n++){t=(t<<5)-t+this.charCodeAt(n),t|=0}return t})},function(t,e,n){"use strict";n.r(e);var r=n(1);n(4);const o={},i=/(http(s)?:\/\/.)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/g,s=async(t,e,n)=>{const r=await fetch(t.toString()),o=await r.text();return a(o,e,n)},a=async(t,e,n)=>l(create(t,!0),e,n),l=async(t,e,n)=>{let r=null;if(t instanceof HTMLTemplateElement)r=new c(t);else{const e=r=document.createElement("template");if(t instanceof Node)r.append(t.cloneNode(!0));else{if(!(t instanceof NodeList||t instanceof HTMLCollection))throw new Error("Template type is not supported!");r.append(t.map(t=>t.cloneNode(!0)))}r=new c(e,n)}return e&&n&&(o[n]=r),r};class c{constructor(t,e){this.template=t,this.key=e}remove(){this.key&&o[this.key]&&delete o[this.key]}static async load(t,e=!0,n=null){if(t instanceof c)return t;const r=((t,e,n)=>{if(!e)return null;let r=null;return n?r=n:"string"==typeof t?r=t:t instanceof URL?r=t.toString():t instanceof HTMLElement&&(r=t.selector()),r?r.hashcode():null})(t,e,n);return r&&o[r]?o[r]:"string"==typeof t?i.test(t)?s(new URL(t,location.origin),e,r):a(t,e,r):t instanceof URL?s(t,e,r):t instanceof Node||t instanceof NodeList||t instanceof HTMLCollection?l(t,e,r):void new Error("The template isn't a allowed type! -> [String|URL|Node|NodeList|HTMLCollection] required!")}}var f=function(){const t=Array.from(arguments),e=t.shift();for(;t.length>0;){t.shift()(e)}},u=n(0);const h=u.default.globalVar("___DOM_API_EXTENSION_MAP___",{});var p=function(t,e){return function(n){let r=h[n.name];r||(r=h[n.name]={}),r[t]?console.warn('duplicated load of extension "'+t+'"!'):(r[t]=!0,e(n.prototype))}};const d=p("EventSupport",t=>{const e=t=>{if(!t.___EVENTHANDLES___){const e=[];t.___EVENTHANDLES___={append:(r,o,i,s)=>{r.forEach(r=>{e.push({event:r,handle:o,wrapper:i,option:s}),n.call(t,r,i,s)})},remove:(n,o)=>{e.filter(t=>(!n||n.indexOf(t.event)>=0)&&(!o||o==t.handle)).forEach(n=>{const o=e.indexOf(n);r.call(t,n.event,n.wrapper),e.splice(o,1)})}}}return t.___EVENTHANDLES___},n=t.addEventListener;t.addEventListener=function(e,n,r){t.on.call(this,e,n,"boolean"==typeof r?{capture:r,once:!1,passive:!1}:r)},t.on=function(){if(arguments.length<2)throw new Error("Too less arguments!");const t=Array.from(arguments),n=t.shift().split(/(\s+)|(\s*,\s*)/),r="string"==typeof t[0]?t.shift():null,o=t.shift(),i=void 0!==t[0]?t.shift():{capture:!1,once:!1,passive:!1},s=function(t){if(r){const e=t.target.nodeType;if(!(e||e!=Node.DOCUMENT_TYPE_NODE&&e!=Node.DOCUMENT_FRAGMENT_NODE||t.target.is(r)))return}const n=o.apply(o,arguments);return i.once&&e(t.currentTarget).remove([t.type],o),n};return e(this).append(n,o,s,i),this};const r=t.removeEventListener;t.removeEventListener=function(){return t.removeOn.apply(this,arguments)},t.removeOn=function(){const t=Array.from(arguments),n="string"==typeof t[0]?t.shift().split(/(\s+)|(\s*,\s*)/):null,r="function"==typeof t[0]?t.shift():null;e(this).remove(n,r)},t.trigger=function(){const t=Array.from(arguments),e=t.shift(),n=t.length>1?t.shift():null,r=n?new Event(e,!0,!0):new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:n});return n instanceof Event&&(r.delegatedEvent=n),this.dispatchEvent(r),this}});f(EventTarget,d);var y=p("DataSupport",t=>{t.data=function(){if(void 0===this.___data___&&(this.___data___={},void 0!==this.dataset))for(name in this.dataset)this.___data___[name]=this.dataset[name];return 0==arguments.length?this.___data___:1==arguments.length?this.___data___[arguments[0]]:(void 0===arguments[1]||null==arguments[1]?delete this.___data___[arguments[0]]:this.___data___[arguments[0]]=arguments[1],this)}});var m=p("ManipulationSupport",t=>{t.empty=function(){let t=this.childNodes;for(;0!=t.length;)t[0].remove(!0);return this},t.content=function(){return this.childNodes},t.html=function(){return 0==arguments.length?this.innerHTML:1==arguments.length&&"boolean"==typeof arguments[0]?arguments[0]?this.outerHTML:this.innerHTML:(Array.from(arguments).forEach(t=>{"string"==typeof t?this.innerHTML=t:(t instanceof Node||t instanceof NodeList)&&(this.empty(),this.append(t))}),this)};const e=function(){const e=t.appendChild.bind(this);for(let t=0;t<arguments.length;t++){let n=arguments[t];n instanceof Node?this.appendChild(n):"string"==typeof n?create(n).forEach(e):"function"==typeof n.forEach&&n.forEach(e)}};t.append=e;const n=function(t,e){this.insertBefore(e,t)};t.prepend=function(){if(0==this.childNodes.length)e.apply(this,arguments);else{const t=this.childNodes.first(),e=n.bind(this,t);for(let t=0;t<arguments.length;t++){const n=arguments[t];n instanceof Node?e(n):"string"==typeof n?n.forEach(e):"function"==typeof n.forEach&&n.forEach(e)}}},t.replace=function(){if(arguments.length<1)throw new Error("Insufficient arguments! One or two nodes required!");const t=1==arguments.length?this.parentNode:this,e=1==arguments.length?this:arguments[0],n=1==arguments.length?arguments[0]:arguments[1];n instanceof Array||n instanceof NodeList||n instanceof HTMLCollection?(n.forEach(n=>t.insertBefore(n,e)),e.remove()):t.replaceChild(n,e)},t.after=function(){if(null==this.parentNode)throw new Error("Can't insert nodes after this node! Parent node not available!");const e=this.parentNode,n=this.nextSibling;n?t.before.apply(n,arguments):t.append.apply(e,arguments)},t.before=function(){if(null==this.parentNode)throw new Error("Can't insert nodes after this node! Parent node not available!");const t=this.parentNode,e=e=>{t.insertBefore(e,this)};for(let t=0;t<arguments.length;t++){const n=arguments[t];n instanceof Node?e(n):"string"==typeof n?n.forEach(e):"function"==typeof n.forEach&&n.forEach(e)}}});f(Node,y,m);const g=/:parent(\(\"([^\)]*)\"\))?/i,v=function(t,e){let n=g.exec(e);if(!n)return t.querySelectorAll(e);{let r=t;if(n.index>0&&(r=t.querySelectorAll(e.substr(0,n.index)),0==r.length))return;if(r=r.parent(n[2]),r){let t=e.substr(n.index+n[0].length).trim();return t.length>0&&(r=r.find(t)),r}}};var _=p("QuerySupport",t=>{t.find=function(){let t=[],e=Array.from(arguments),n=e.shift();for(;n;){if("string"==typeof n){let e=v(this,n);e&&t.push(e)}n=e.shift()}let r=NodeList.from.apply(null,t);return r},t.is=function(){if(this instanceof Document)return!1;if(1==arguments.length){if("string"==typeof arguments[0])return this.matches(arguments[0]);if("number"==typeof arguments[0].length){let t=arguments[0];for(let e=0;e<t.length;e++)if(this.matches(t[e]))return!0}}else if(arguments.length>1)return this.is(Array.from(arguments));return!1},t.parent=function(){if(this.parentNode){if("string"==typeof arguments[0]){let t=this.parentNode;try{for(;t&&!t.is(arguments[0]);)t=t.parent(arguments[0])}catch(e){console.error("this:",this,"parent:",t,"error:",e)}return t}return this.parentNode}},t.parents=function(){let e=new Array,n=t.parent.apply(this,arguments);for(;n;)e.push(n),n=t.parent.apply(n,arguments);return NodeList.from(e)},t.selector=function(){if(!(this instanceof Document||this instanceof DocumentFragment)){if(this.id)return"#"+this.id;{let t=this.tagName.toLowerCase(),e=this.parent();if(e){let n=e.find(":scope>"+t);if(n instanceof NodeList){let e=n.indexOf(this);e>0&&(t+=":nth-child("+(e+1)+")")}let r=e.selector();return r?r+">"+t:t}return t}}},t.closest=function(t){let e=this;for(;e;){let n=e.find(t);if(n&&n.length>0)return n;if(e.is(t))return NodeList.from(e);e=e.parent()}},t.nested=function(t){if(this.is(t))return NodeList.from(this);let e=this.find(t);return e&&e.length>0?e:NodeList.from(this.parent(t))}});const w=p("AttributeSupport",t=>{t.attr=function(){return 0==arguments.length?this.hasAttributes()?(()=>{const t={};return this.getAttributeNames().forEach(e=>{t[e]=this.getAttribute(e)}),t})():void 0:1==arguments.length?this.getAttribute(arguments[0]):(void 0===arguments[1]||null==arguments[1]?this.removeAttribute(arguments[0]):this.setAttribute(arguments[0],arguments[1]),this)}});f(Element,_,w,m);const E=p("ReadyEventSupport",t=>{t.ready=function(t,e){return this.on("ready",t,e),"complete"==document.readyState&&this.trigger("ready"),this}});f(Document,_,E),document.addEventListener("DOMContentLoaded",()=>document.trigger("ready")),f(DocumentFragment,_,m);var N=p("HtmlClassSupport",t=>{t.addClass=function(){return 1==arguments.length?arguments[0].split(/\s+/).forEach(t=>this.classList.add(t)):arguments.length>1&&Array.prototype.forEach.call(arguments,t=>this.addClass(t)),this},t.removeClass=function(){return 1==arguments.length?arguments[0].split(/\s+/).forEach(t=>this.classList.remove(t)):arguments.length>1&&Array.prototype.forEach.call(arguments,t=>this.removeClass(t)),this},t.toggleClass=function(){return 1==arguments.length?arguments[0].split(/\s+/).forEach(t=>this.classList.toggle(t)):arguments.length>1&&Array.prototype.forEach.call(arguments,t=>this.toogleClass(t)),this}});const L=p("ShowHideSupport",t=>{t.show=function(){return this.___hidden__&&(this.style.display=this.___display___||"",this.___hidden__=!1),this},t.hide=function(){return this.___hidden__||(this.___display___=this.style.display,this.style.display="none",this.___hidden__=!0),this},t.toggleShow=function(){return this.___hidden__?this.show():this.hide()}});f(HTMLElement,N,L);const T=[{selector:"select",get:function(){const t=[];return this.find("option").forEach(e=>{e.selected&&t.push(e.value)}),t},set:function(){let t=[];const e=Array.from(arguments);let n=e.shift();for(;n;)Array.isArray(n)?t=t.concat(n):t.push(n),n=e.shift();this.value=t,this.find("option").forEach(e=>e.selected=t.indexOf(e.value)>=0),this.trigger("changed")}},{selector:'input[type="checkbox"], input[type="radio"]',get:function(){return"on"==this.value||"off"==this.value?this.checked:this.checked?this.value:void 0},set:function(t){"boolean"==typeof t?this.checked=t:"string"==typeof t?this.checked=this.value==t:Array.isArray(t)&&(this.checked=t.indexOf(this.value)>=0),this.trigger("changed")}}],x={get:function(){return this.value},set:function(t){this.value=t,this.trigger("input")}},b=function(t){for(let e=0;e<T.length;e++)if(t.is(T[e].selector))return T[e];return x};var A=p("ValueSupport",t=>{t.val=function(){let t=b(this);return 0==arguments.length?t.get.apply(this,arguments):(t.set.apply(this,arguments),this)}});f(HTMLInputElement,A),f(HTMLTextAreaElement,p("ValueSupport",t=>{t.val=function(){return 0==arguments.length?this.value:(this.value=arguments[0],this)}})),f(HTMLSelectElement,A);var M=function(){const t=Array.from(arguments),e=t.shift(),n=t.shift();t.forEach(t=>{Object.getOwnPropertyNames(t).forEach(r=>{const o=Object.getOwnPropertyDescriptor(t,r);void 0===n[r]&&"function"==typeof o.value&&(n[r]=function(){return e.call(this,r,arguments)})})})};var H=p("ListSupport",t=>{t.indexOf=function(){for(let t=0;t<this.length;t++)if(this[t]==arguments[0])return t;return-1},t.forEach=function(){return Array.prototype.forEach.apply(Array.from(this),arguments)},t.map=function(){return Array.prototype.map.apply(Array.from(this),arguments)},t.filter=function(){return Array.prototype.filter.apply(Array.from(this),arguments)},t.first=function(){if(this.length>0)return this[0]},t.last=function(){if(this.length>0)return this[this.length-1]}});f(NodeList,H),NodeList.prototype.applyTo=function(){const t=Array.from(arguments),e=t.shift(),n="function"==typeof e,r=[];for(let o=0;o<this.length;o++){const i=this[o];let s;n?s=e.apply([i].concat(t)):"function"==typeof i[e]&&(s=i[e].apply(i,t)),s&&r.push(s)}return r},NodeList.prototype.val=function(){if(0==arguments.length){if(this.length>0){const t=new Map;return this.forEach(e=>{if("function"==typeof e.val){e.val()&&t.set(e.name||e.id||e.selector(),e.val())}}),t}}else NodeList.prototype.applyTo.apply(this,["val"].concat(Array.from(arguments)))},NodeList.from=function(){const t=Array.from(arguments),e={};let n=0;for(;t.length>0;){const r=t.shift();if(void 0!==r&&null!=r)if(r instanceof Node)e[n++]={value:r,enumerable:!0};else if(r instanceof NodeList||r instanceof HTMLCollection||r instanceof Array)for(let t=0;t<r.length;t++)r[t]&&r[t]instanceof Node&&(e[n++]={value:r[t],enumerable:!0})}return e.length={value:n},Object.create(NodeList.prototype,e)},M((function(t,e){let n=[];return this.forEach(r=>{if(r&&"function"==typeof r[t]){const o=r[t].apply(r,e);o&&(o instanceof NodeList?n=n.concat(Array.from(o)):n.push(o))}}),0===n.length?void 0:n[0]instanceof Node||n[0]instanceof NodeList?NodeList.from.apply(null,n):n}),NodeList.prototype,Node.prototype,HTMLElement.prototype,HTMLInputElement.prototype,Element.prototype,EventTarget.prototype),f(HTMLCollection,H),HTMLCollection.prototype.applyTo=function(){const t=Array.from(arguments),e=t.shift(),n="function"==typeof e,r=[];for(let o=0;o<this.length;o++){const i=this[o];let s;n?s=e.apply([i].concat(t)):"function"==typeof i[e]&&(s=i[e].apply(i,t)),s&&r.push(s)}return r},HTMLCollection.prototype.val=function(){if(0==arguments.length){if(this.length>0){const t=new Map;return this.forEach(e=>{if("function"==typeof e.val){e.val()&&t.set(e.name||e.id||e.selector(),e.val())}}),t}}else HTMLCollection.prototype.applyTo.apply(this,["val"].concat(Array.from(arguments)))},HTMLCollection.from=function(){const t=Array.from(arguments),e={};let n=0;for(;t.length>0;){const r=t.shift();if(void 0!==r&&null!=r)if(r instanceof HTMLElement)e[n++]={value:r,enumerable:!0};else if(r instanceof HTMLCollection||r instanceof NodeList||r instanceof Array)for(let t=0;t<r.length;t++)r[t]&&r[t]instanceof HTMLElement&&(e[n++]={value:r[t],enumerable:!0})}return e.length={value:n},Object.create(HTMLCollection.prototype,e)},M((function(t,e){let n=[];return this.forEach(r=>{if(r&&"function"==typeof r[t]){let o=r[t].apply(r,e);o&&(o instanceof HTMLCollection?n=n.concat(Array.from(o)):n.push(o))}}),0===n.length?void 0:n[0]instanceof HTMLElement||n[0]instanceof HTMLCollection?HTMLCollection.from.apply(null,n):n}),HTMLCollection.prototype,Node.prototype,HTMLElement.prototype,HTMLInputElement.prototype,Element.prototype,EventTarget.prototype),u.default.global.defaultjs=u.default.global.defaultjs||{},u.default.global.defaultjs.extdom=u.default.global.defaultjs.extdom||{VERSION:"1.0.0-beta.1",utils:{Utils:u.default}},u.default.global.find=function(){return document.find.apply(document,arguments)},u.default.global.ready=function(){return document.ready.apply(document,arguments)},u.default.global.create=function(t,e){if("string"!=typeof arguments[0])throw new Error("The first argument must be a string!");const n=document.createElement("template");return n.innerHTML=t,e?n:document.importNode(n.content,!0).childNodes},u.default.global.script=function(t,e){return t instanceof Array?Promise.all(t.map(t=>u.default.global.script(t,e))):"string"==typeof t?new Promise((n,r)=>{const o=document.createElement("script");o.async=!0,o.onload=function(){n()},o.onerror=function(){r("jquery load error!")},e?e.append(o):document.body.append(o),o.src=t}):Promise.reject("First parameter must be an array of strings or a string!")};var C=n(3);class S{constructor(t,e){this.key=t,this.context=e}get keyDefined(){return this.key in this.context}get hasValue(){return!!this.context[this.key]}get value(){return this.context[this.key]}set value(t){this.context[this.key]=t}set append(t){if(this.hasValue){const e=this.value;e instanceof Array?e.push(t):this.value=[this.value,t]}else this.value=t}remove(){delete this.context[this.key]}static load(t,e,n=!0){let r=t;const o=e.split(".");let i=o.shift().trim();for(;o.length>0;){if(!r[i]){if(!n)return null;r[i]={}}r=r[i],i=o.shift().trim()}return new S(i,r)}}class O{constructor(t){this.hasValue=1==arguments.length,this.value=t}}const j=/\$\{(([a-zA-Z0-9\-_\s]+)::)?([^\{\}]+)\}/,k=new O,D=t=>t instanceof O?t:new O(t),P=async function(t,e,n,r){if(n&&t.name!=n)return t.parent?P(t.parent,e,n,r):null;const o=await async function(t,e){if("string"!=typeof t)return t;const n=new Function("aContext","try{\twith(aContext) {\t\treturn "+t+";\t}}catch(e){\tthrow e;}");return await n(e)}(e,t.context);return null!=o?o:null!==t.parent?await P(t.parent,e,n,r):r instanceof O&&r.hasValue?r.value:o},V=t=>t?V(t.parent)+"/"+t.name:"";class F{constructor({context:t=C.default,parent:e=null,name:n=null}){this.parent=e instanceof F?e:null,this.name=n,this.context=t}get fullname(){return V(this)}async getData(t,e){if(t&&e&&e!=this.name){if(!this.parent){const e=S.load(this.context,t,!1);return e?e.value:null}this.parent.updateData(t,value,e)}}async updateData(t,e,n){if(t&&n&&n!=this.name)if(this.parent)this.parent.updateData(t,e,n);else{S.load(this.context,t).value=e}}async resolve(t,e){const n=2==arguments.length?D(e):k;try{const e=j.exec(t);return e?await P(this,e[3],(t=>t?0==(t=t.trim()).length?null:t:null)(e[2]),n):await P(this,t,null,n)}catch(e){return console.error('error at executing statment"',t,'":',e),n.hasValue?n.value:t}}async resolveText(t,e){let n=t,r=t,o=j.exec(n);const i=2==arguments.length?D(e):k;for(;null!=o;){const t=await this.resolve(o[0],i);r=r.split(o[0]).join(),n=n.split(o[0]).join(void 0===t?"undefined":null==t?"null":t),o=j.exec(r)}return n}static async resolve(t,e,n,r){const o=new F({context:e}),i=arguments.length>2?D(n):k;return"number"==typeof r&&r>0?new Promise(e=>{setTimeout(()=>{e(o.resolve(t,i))},r)}):o.resolve(t,i)}static async resolveText(t,e,n,r){const o=new F({context:e}),i=arguments.length>2?D(n):k;return"number"==typeof r&&r>0?new Promise(e=>{setTimeout(()=>{e(o.resolveText(t,i))},r)}):o.resolveText(t,i)}}class I{constructor({renderer:t,container:e,root:n,target:r=null,parent:o=null}){if(!t)throw new Error('Parameter "renderer" is required!');if(!e)throw new Error('Parameter "container" is required!');if(!n)throw new Error('Parameter "root" is required!');this.readyHandles=[],this.finallyHandles=[],this.content=null,this.container=e,this.renderer=t,this.root=n,this.target=r,this.parent=o,this.stop=!1,this.ignore=!1}get finally(){return this.finallyHandles}set finally(t){this.parent?this.parent.finally=t:t instanceof Array?this.readyhandles=this.readyhandles.concat(t):this.readyhandles.push(t)}get ready(){return this.readyHandles=[]}set ready(t){t instanceof Array?this.readyHandles=this.readyHandles.concat(t):this.readyHandles.push(t)}clone({renderer:t,container:e,root:n,target:r}={}){return new I({renderer:t||this.renderer,container:e||this.container,root:n||this.root,target:r||this.target,parent:this})}}const R=[];class q{constructor(){}get name(){}get rank(){}async accept({tempalte:t,context:e}){return!0}async execute({tempalte:t,context:e}){return e}static define(t){(({directive:t})=>{if(!(t instanceof q))throw new Error("Implementation dosn't extend Directive class!");if(t.rank<0)throw new Error("The rank ofa directive must be positive(0 <= rank)!");R.push(t),R.sort((t,e)=>t.rank-e.rank)})(t)}static get directives(){return R}}class U extends HTMLElement{constructor(){super()}}customElements.define("jstl-replace",U);q.define({directive:new class extends q{constructor(){super()}get name(){return"initial"}get rank(){return 0}async accept({tempalte:t,context:e}){return!0}async execute({template:t,context:e}){if(!(t instanceof HTMLElement)&&t instanceof Node)e.content=t.cloneNode(!0);else if(t.attr("jstl-async")){e.content=new U;const n=n.cloneNode(!0);n.attr("jstl-async",null),setTimeout(async()=>{await e.renderer.render({template:n,mode:"replace",target:e.content,context:e.clone({target:e.content})})},parseInt(t.attr("jstl-async")||"250")||250)}else t.attr("jstl-ignore")?(e.content=t.cloneNode(!0),e.stop=!0,e.ignore=!0):t instanceof HTMLElement?e.content=t.cloneNode(!1):(e.stop=!0,e.ignore=!0);return e}}});const z={application:"application",data:"data",renderer:"renderer",container:"container",node:"node"},B=new F({name:z.application}),Z={replace:async({container:t,target:e=null,content:n})=>{e?e.replace(n):(t.empty(),t.append(n))},append:async({container:t,target:e=null,content:n})=>{e?e.after(n):t.append(n)},prepend:async({container:t,target:e=null,content:n})=>{e?e.before(n):t.prepend(n)}},$=t=>t?t instanceof c?t.template:t instanceof Node||t instanceof NodeList||t instanceof HTMLCollection?t:"string"==typeof t?create(t):null:null;class G{constructor({template:t,data:e,scope:n=z.application,parent:r=null}={}){this.scope=n,this.template=$(t),this.parent=r instanceof G?r:null,e?this.resolver=new F({name:n||z.data,context:e,parent:r?r.resolver:B}):this.parent?this.resolver=this.parent.resolver:this.resolver=B}get chain(){return this.parent?this.parent.chain+"/"+this.scope:"/"+this.scope}scopeFilter(t,e=!1){if(e)return this.scope==t?this:this.parent.scopeFilter(t,!0);{const e=this.parent?this.parent.scopeFilter(t):null;return e||(this.scope==t?this:null)}}async render({template:t=null,data:e=null,container:n,root:r,mode:o="replace",target:i,context:s=null}){t=$(t);let a=null;s?(a=this.scopeFilter(z.renderer),s=s.clone({renderer:a,container:n,root:r,target:i})):(a=new G({data:e||{},scope:z.renderer,parent:this}),s=new I({renderer:a,container:n,root:r||n,target:i}));let l=null;if(l=t instanceof Node?await a.renderNode({template:t||this.template,context:s}):await a.renderContainer({template:t||this.template,context:s}),l instanceof I&&(s=l),o){const t=Z[o];if(!t)throw new Error('The "'+o+'" is not supported!');await t(s)}return r&&n!=r||await Promise.all(s.ready.map(t=>t({context:s}))),s.content}async renderContainer({template:t,context:e}){if(t&&t.length>0){let n=e.renderer.scopeFilter(z.container);n=n?n.clone({template:t}):new G({template:t,data:{},scope:z.container,parent:e.renderer}),e=e.clone({renderer:n});const r=t.map(t=>n.renderNode({template:t,context:e}));let o=await Promise.all(r);o=o.filter(t=>!!t.content).map(t=>t.content),o.length>0&&(e.content=[],o.forEach(t=>{t instanceof Array||t instanceof NodeList||t instanceof HTMLCollection?e.content=e.content.concat(t):t instanceof Node&&e.content.push(t)}))}return e}async renderNode({template:t,context:e}){let n=new G({template:t,data:{},scope:z.node,parent:e.renderer});if(e=e.clone({renderer:n}),await this.executeDirectives({template:t,context:e})instanceof I&&(e=e),!e.content)return null;if(!e.ignore){const n=t.childNodes;if(n&&n.length>0){const t=e.clone({container:e.content});await e.renderer.render({template:n,context:t,mode:"replace"})}}return e}async executeDirectives({template:t,context:e}){console.log("scope chain:",e.renderer.chain,"resolver chain",e.renderer.resolver.fullname);const n=q.directives,r=n.length;for(let o=0;o<r;o++){const r=n[o];if(await r.accept({template:t,context:e})){const n=await r.execute({template:t,context:e});n instanceof I&&(e=n)}}return e}clone({template:t,data:e,scope:n}={}){return new G({template:t||this.template,data:e||{},scope:n||this.scope,parent:this.parent})}static async render({container:t,data:e,template:n,mode:r,target:o}){return new G({template:n,data:e,scope:z.render}).render({container:t,mode:r,target:o})}}r.default.defaultjs=r.default.defaultjs||{},r.default.defaultjs.tl=r.default.defaultjs.tl||{VERSION:"1.0.0-beta.1",Template:c,Renderer:G}}]);
//# sourceMappingURL=defaultjs-template-language.min.js.map