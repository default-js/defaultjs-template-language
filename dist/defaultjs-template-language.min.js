!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=7)}([function(t,e,n){"use strict";e.a={EVENTS:{onExecute:"jstl-on-execute",onSuccess:"jstl-on-success",onFail:"jstl-on-fail",onReady:"jstl-on-ready"},PHASE:{INIT:1e3,CONDITION:2e3,CONTEXT:3e3,MANIPULATION:4e3,CONTENT:5e3,CLEANING:6e3,CHILDREN:7e3,BINDING:8e3,FINISH:9e3}}},function(t,e,n){"use strict";var r=n(0);const o=function(t,e){return console.log("execute chain",e.task.id,"context:"+t),Promise.resolve(e.task.accept(t)).then((function(n){return n?Promise.resolve(e.task.execute(t)).then((function(t){return t.exit||null==e.next?t:o(t,e.next)})):null==e.next?t:o(t,e.next)}))};j;const i=new function(){const t={};return{chain:null,add:function(e,n){void 0===t[e.id]&&(this.chain=function(t,e){if(null==e)return t;let n=null,r=e;for(;null!=r;){if(r.phase>t.phase)return t.next=r,null==n?t:(n.next=t,e);n=r,r=r.next}return n.next=t,e}({task:e,phase:void 0!==n?n:r.a.PHASE.FINISH,next:null},this.chain))},execute:function(t,e,n){return o({element:t,data:e,root:n||t,exit:!1},this.chain)}}},s=function(t,e,n){return console.log("execute element",t.selector(),"- root",n?n.selector():void 0),t.trigger(r.a.EVENTS.onExecute),i.execute(t,e,n).then((function(){return void 0===n&&t.trigger(r.a.EVENTS.onReady),{element:t,data:e,root:n}})).catch((function(e){throw void 0===n&&t.trigger(r.a.EVENTS.onFail),e}))},a=function(t,e,n){return s(t.shift(),e,n).then((function(e){return 0!=t.length?a(t,e.data,e.root):e}))},l={addTask:function(t,e){i.add(t,e)},getTaskchain:function(){return i},execute:function(t,e,n){return void 0===t||null==t?Promise.reject(new Error('Parameter "aElement" is undefined!')):t instanceof NodeList?a(Array.from(t),e,n).then((function(){return{element:t,data:e,root:n}})):t instanceof Array?a(t,e,n).then((function(){return{element:t,data:e,root:n}})):t instanceof Node?s(t,e,n):Promise.reject(new Error('Type of "aElement" - "'+typeof t+'" is not supported!'))}};e.a=l},function(t,e,n){"use strict";const r=/\$\{([^\{\}]+)\}/,o=function(t,e,n,r){if("number"==typeof r&&r>0)return new Promise((function(r){setTimeout((function(){r(o(t,e,n))}))}));if("string"!=typeof t)return Promise.resolve(t);let i=t.trim();if(0==i.length)return Promise.resolve(n);try{return new Function("aContext","try{\twith(aContext || window || global || self || this){\t\treturn Promise.resolve("+i+");\t}}catch(e){\tthrow e;}")(e).then((function(t){return void 0===t?Promise.resolve(n):Promise.resolve(t)})).catch((function(t){return Promise.reject(t)}))}catch(t){return Promise.reject(t)}},i=function(t,e,n,s){if("number"==typeof s&&s>0)return new Promise((function(r){setTimeout((function(){r(i(t,e,n))}))}));const a=r.exec(t);return null!=a?o(a[1],e,n).then((function(r){return i(t.split(a[0]).join(r),e,n)})):Promise.resolve(t)};var s={ExpressionResolver:{resolve:function(t,e,n,i){const s=r.exec(t);return o(s?s[1]:t,e,n,i)},resolveText:i}};e.a=s},function(t,e,n){"use strict";const r=function(t){return void 0!==t&&null!=t&&"Object"===t.constructor.name},o=function(t){for(let e=1;e<arguments.length;e++){const n=arguments[e];Object.getOwnPropertyNames(n).forEach((function(e){r(t[e])?o(t[e],n[e]):t[e]=n[e]}))}return t};e.a={isPojo:r,append:function(t,e,n){if(void 0!==e){let r=t.toLowerCase().trim();if(void 0===n[r])n[r]=e;else{let t=n[r];t instanceof Array?t.push(e):n[r]=[n[r],e]}}return n},merge:o}},function(t,e,n){"use strict";(function(t){const n={global:window||t||self||{},globalVar:function(t,e){return 2===arguments.length&&void 0===n.global[t]&&(n.global[t]=e),n.global[t]}};e.a=n}).call(this,n(5))},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";(function(t){var e=n(0),r=n(1),o=n(2),i=n(3);const s=o.a.ExpressionResolver,a=window||t||self||{},l={direct:function(t,e){return s.resolve(t,e.data)},remote:function(t,e){return Promise.all([s.resolveText(t,e.data),s.resolve(e.element.attr("jstl-data-options")||"undefined",e.data)]).then((function(t){return fetch(t[0],i.a.isPojo(t[1])?t[1]:null)})).then((function(t){return s.resolveText(e.element.attr("jstl-data-datatype")||"json",e.data).then((function(n){const r=u[n];if("function"==typeof r)return r(t,e)}))}))},"url-parameter":function(t,e){return s.resolveText(t,e.data).then((function(t){return function(t){const e=t.replace(/[\[\]]/g,"\\$&");new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(a.location.search);return results?results[2]?a.decodeURIComponent(results[2].replace(/\+/g," ")):"":void 0}(t)}))}},u={json:function(t){return t.json()}},c={id:"data",accept:function(t){return t.element.is("[jstl-data]")},execute:function(t){const e=t.element.attr("jstl-data-mode")||"direct",n=l[e];if("function"!=typeof n)return Promise.resolve(t);const r=t.element.attr("jstl-data-var"),o=t.element.attr("jstl-data-default"),a=t.element.attr("jstl-data");return Promise.resolve(n(a,t)).then((function(e){return void 0===e?s.resolve(o,t.data):e})).then((function(e){return r?t.data[r]=e:void 0!==e&&i.a.merge(t.data,e),t}))}};r.a.addTask(c,e.a.PHASE.CONTEXT+100)}).call(this,n(5))},function(t,e,n){"use strict";n.r(e);var r=function(){let t=Array.from(arguments),e=t.shift();for(;t.length>0;){t.shift()(e)}},o=n(4);const i=o.a.globalVar("__DOM_API_EXTENSION_MAP__",{});var s=function(t,e){return function(n){let r=i[n.name];r||(r=i[n.name]={}),r[t]?console.warn('duplicated load of extension "'+t+'"!'):(r[t]=!0,e(n.prototype))}};const a=s("EventSupport",(function(t){const e=function(t,e,n){if(void 0!==t.filter&&!n.target.is(t.filter))return;let r=[n];void 0!==t.data&&(r=r.concat(t.data));let o=e.apply(e,r);return t.singleCall&&this.removeEventListener(e),o},n=t.addEventListener;t.addEventListener=function(){if(arguments.length<2)throw new Error("Too less arguments!");this.on(arguments[0],arguments[1])},t.on=function(){if(arguments.length<2)throw new Error("Too less arguments!");void 0===this.__callbackMap&&(this.__callbackMap={});let t=Array.from(arguments),r=t.shift().split(/(\s+)|(\s*,\s*)/),o={filter:"string"==typeof t[0]?t.shift().split(/\s*,\s*/):void 0,data:"function"!=typeof t[0]?t.shift():void 0},i=t.shift();o.singleCall="boolean"!=typeof t[0]&&t.shift();let s={};return r.forEach(function(t,r,o,i){let a=e.bind(this,r,o);s[i]=a,n.call(this,i,a,!0)}.bind(this,s,o,i)),this.__callbackMap[i]=s,this};const r=t.removeEventListener;t.removeEventListener=t.removeOn=function(){if(1!=arguments.length||void 0===this.__callbackMap)return r.apply(this,arguments);let t=void 0,e=void 0;if("string"==typeof arguments[0])t=arguments[0].split(/(\s+)|(\s*,\s*)/);else{if("function"!=typeof arguments[0])throw new Error("Wrong argument! -> call function([event|handler])");e=arguments[0]}let n=[];if(void 0===t){let t=this.__callbackMap[e];void 0!==t&&(Object.getOwnPropertyNames(t).forEach(function(t,e,n){let r=e[n];void 0!==r&&t.push(r)}.bind(this,n,t)),delete this.__callbackMap[e])}else t.forEach(function(t,e){Object.getOwnPropertyNames(this.__callbackMap).forEach(function(t,e){let n=this.__callbackMap[e];delete n[t],0==Object.getOwnPropertyNames(n).length&&delete this.__callbackMap[e]}.bind(this,e))}.bind(this));return this},t.trigger=function(){let t=Array.from(arguments),e=t.shift(),n=t.length>1?t.shift():void 0,r=n instanceof Event?n:void 0;return"function"==typeof this["on"+e]?(e=document.createEvent("Event"),e.initEvent(e,!0,!0)):e=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:n}),e.delegatedEvent=r,this.dispatchEvent(e),this}}));r(EventTarget,a);var l=s("DataSupport",(function(t){t.data=function(){if(void 0===this.__data__&&(this.__data__={},void 0!==this.dataset))for(name in this.dataset)this.__data__[name]=this.dataset[name];return 0==arguments.length?this.__data__:1==arguments.length?this.__data__[arguments[0]]:(void 0===arguments[1]||null==arguments[1]?delete this.__data__[arguments[0]]:this.__data__[arguments[0]]=arguments[1],this)}}));var u=s("ManipulationSupport",(function(t){t.empty=function(){let t=this.childNodes;for(;0!=t.length;)t[0].remove(!0);return this},t.content=function(){return this.childNodes},t.html=function(){return 0==arguments.length?this.innerHTML:1==arguments.length&&"boolean"==typeof arguments[0]?arguments[0]?this.outerHTML:this.innerHTML:(Array.from(arguments).forEach(function(t){"string"==typeof t?this.innerHTML=t:(t instanceof Node||t instanceof NodeList)&&(this.empty(),this.append(t))}.bind(this)),this)},t.append=function(){let e=t.appendChild.bind(this);for(let t=0;t<arguments.length;t++){let n=arguments[t];n instanceof Node?this.appendChild(n):"string"==typeof n?create(n).forEach(e):(Array.isArray(n)||n instanceof NodeList)&&n.forEach(e)}};const e=function(t,e){this.insertBefore(e,t)};t.prepend=function(){let t=this.childNodes.first(),n=e.bind(this,t);for(let e=0;e<arguments.length;e++){let r=arguments[e];Array.isArray(r)||r instanceof NodeList?r.forEach(n):r instanceof Node?this.insertBefore(r,t):"string"==typeof r&&r.forEach(n)}},t.replace=function(){if(arguments.length<1)throw new Error("Insufficient arguments! One or two nodes required!");const t=1==arguments.length?this.parentNode:this,e=1==arguments.length?this:arguments[0],n=1==arguments.length?arguments[0]:arguments[1];n instanceof Array||n instanceof NodeList?(n.forEach((function(n){t.insertBefore(n,e)})),e.remove()):t.replaceChild(e,n)}}));r(Node,l,u);const c=/:parent(\(\"([^\)]*)\"\))?/i,f=function(t,e){let n=c.exec(e);if(!n)return t.querySelectorAll(e);{let r=t;if(n.index>0&&(r=t.querySelectorAll(e.substr(0,n.index)),0==r.length))return;if(r=r.parent(n[2]),r){let t=e.substr(n.index+n[0].length).trim();return t.length>0&&(r=r.find(t)),r}}};var h=s("QuerySupport",(function(t){t.find=function(){let t=[],e=Array.from(arguments),n=e.shift();for(;n;){if("string"==typeof n){let e=f(this,n);e&&t.push(e)}n=e.shift()}let r=NodeList.from.apply(null,t);return r},t.is=function(){if(this instanceof Document)return!1;if(1==arguments.length){if("string"==typeof arguments[0])return this.matches(arguments[0]);if("number"==typeof arguments[0].length){let t=arguments[0];for(let e=0;e<t.length;e++)if(this.matches(t[e]))return!0}}else if(arguments.length>1)return this.is(Array.from(arguments));return!1},t.parent=function(){if(this.parentNode){if("string"==typeof arguments[0]){let t=this.parentNode;try{for(;t&&!t.is(arguments[0]);)t=t.parent(arguments[0])}catch(e){console.error("this:",this,"parent:",t,"error:",e)}return t}return this.parentNode}},t.parents=function(){let e=new Array,n=t.parent.apply(this,arguments);for(;n;)e.push(n),n=t.parent.apply(n,arguments);return NodeList.from(e)},t.selector=function(){if(!(this instanceof Document||this instanceof DocumentFragment)){if(this.id)return"#"+this.id;{let t=this.tagName.toLowerCase(),e=this.parent();if(e){let n=e.find(":scope>"+t);if(n instanceof NodeList){let e=n.indexOf(this);e>0&&(t+=":nth-child("+(e+1)+")")}let r=e.selector();return r?r+">"+t:t}return t}}},t.closest=function(t){let e=this;for(;e;){let n=e.find(t);if(n&&n.length>0)return n;if(e.is(t))return NodeList.from(e);e=e.parent()}},t.nested=function(t){if(this.is(t))return NodeList.from(this);let e=this.find(t);return e&&e.length>0?e:NodeList.from(this.parent(t))}}));const d=s("AttributeSupport",(function(t){t.attr=function(){return 0==arguments.length?this.hasAttributes()?function(){let t={};return this.getAttributeNames().forEach(function(t,e){t[e]=this.getAttribute(e)}.bind(this,t)),t}.call(this):void 0:1==arguments.length?this.getAttribute(arguments[0]):(void 0===arguments[1]||null==arguments[1]?this.removeAttribute(arguments[0]):this.setAttribute(arguments[0],arguments[1]),this)}}));r(Element,h,d,u);const p=s("ReadyEventSupport",(function(t){t.ready=function(t,e){return this.on("ready",t,e),"complete"==document.readyState&&this.trigger("ready"),this}}));r(Document,h,p),document.addEventListener("DOMContentLoaded",(function(){document.trigger("ready")})),r(DocumentFragment,h,u);var m=s("HtmlClassSupport",(function(t){t.addClass=function(){return 1==arguments.length?arguments[0].split(/\s+/).forEach(function(t){this.classList.add(t)}.bind(this)):arguments.length>1&&Array.prototype.forEach.call(arguments,function(t){this.addClass(t)}.bind(this)),this},t.removeClass=function(){return 1==arguments.length?arguments[0].split(/\s+/).forEach(function(t){this.classList.remove(t)}.bind(this)):arguments.length>1&&Array.prototype.forEach.call(arguments,function(t){this.removeClass(t)}.bind(this)),this},t.toggleClass=function(){return 1==arguments.length?arguments[0].split(/\s+/).forEach(function(t){this.classList.toggle(t)}.bind(this)):arguments.length>1&&Array.prototype.forEach.call(arguments,function(t){this.toogleClass(t)}.bind(this)),this}}));const g=s("ShowHideSupport",(function(t){t.show=function(){return this.__ishide&&(this.style.display=this.__display||"",this.__ishide=!1),this},t.hide=function(){return this.__ishide||(this.__display=this.style.display,this.style.display="none",this.__ishide=!0),this},t.toggleShow=function(){return this.__ishide?this.show():this.hide()}}));r(HTMLElement,m,g);const v=[{selector:"select",get:function(){let t=[];return this.find("option").forEach((function(e){e.selected&&t.push(e.value)})),t},set:function(){let t=[],e=Array.from(arguments),n=e.shift();for(;n;)Array.isArray(n)?t=t.concat(n):t.push(n),n=e.shift();this.value=t,this.find("option").forEach((function(e){e.selected=t.indexOf(e.value)>=0})),this.trigger("changed")}},{selector:'input[type="checkbox"], input[type="radio"]',get:function(){return"on"==this.value||"off"==this.value?this.checked:this.checked?this.value:void 0},set:function(t){"boolean"==typeof t?this.checked=t:"string"==typeof t?this.checked=this.value==t:Array.isArray(t)&&(this.checked=t.indexOf(this.value)>=0),this.trigger("changed")}}],y={get:function(){return this.value},set:function(t){this.value=t,this.trigger("input")}},x=function(t){for(let e=0;e<v.length;e++)if(t.is(v[e].selector))return v[e];return y};var b=s("ValueSupport",(function(t){t.val=function(){let t=x(this);return 0==arguments.length?t.get.apply(this,arguments):(t.set.apply(this,arguments),this)}}));r(HTMLInputElement,b),r(HTMLTextAreaElement,s("ValueSupport",(function(t){t.val=function(){return 0==arguments.length?this.value:(this.value=arguments[0],this)}}))),r(HTMLSelectElement,b);var E=function(){let t=Array.from(arguments),e=t.shift(),n=t.shift();t.forEach(function(t,e,n){Object.getOwnPropertyNames(n).forEach(function(t,e,n,r){let o=Object.getOwnPropertyDescriptor(e,r);void 0===t[r]&&"function"==typeof o.value&&(t[r]=function(){return n.call(this,r,arguments)})}.bind(null,t,n,e))}.bind(null,n,e))};const N=s("ListSupport",(function(t){t.indexOf=function(){for(let t=0;t<this.length;t++)if(this[t]==arguments[0])return t;return-1},t.forEach=function(){return Array.prototype.forEach.apply(Array.from(this),arguments)},t.first=function(){if(this.length>0)return this[0]},t.last=function(){if(this.length>0)return this[this.length-1]}}));r(NodeList,N),NodeList.prototype.applyTo=function(){let t=Array.from(arguments),e=t.shift(),n="function"==typeof e,r=[];for(let o=0;o<this.length;o++){let i,s=this[o];n?i=e.apply([s].concat(t)):"function"==typeof s[e]&&(i=s[e].apply(s,t)),i&&r.push(i)}return r},NodeList.prototype.val=function(){if(0==arguments.length){if(this.length>0){let t=new Map;return this.forEach((function(e){if("function"==typeof e.val){e.val()&&t.set(e.name||e.id||e.selector(),e.val())}})),t}}else NodeList.prototype.applyTo.apply(this,["val"].concat(Array.from(arguments)))},NodeList.from=function(){let t=Array.from(arguments),e={},n=0;for(;t.length>0;){let r=t.shift();if(void 0!==r&&null!=r)if(r instanceof Node)e[n++]={value:r,enumerable:!0};else if(r instanceof NodeList||Array.isArray(r))for(let t=0;t<r.length;t++)r[t]&&r[t]instanceof Node&&(e[n++]={value:r[t],enumerable:!0})}return e.length={value:n},Object.create(NodeList.prototype,e)},E((function(t,e){let n=[];return this.forEach((function(r){if(r&&"function"==typeof r[t]){let o=r[t].apply(r,e);o&&(o instanceof NodeList?n=n.concat(Array.from(o)):n.push(o))}})),0===n.length?void 0:n[0]instanceof Node||n[0]instanceof NodeList?NodeList.from.apply(null,n):n}),NodeList.prototype,Node.prototype,HTMLElement.prototype,HTMLInputElement.prototype,Element.prototype,EventTarget.prototype),o.a.global.defaultjs=o.a.global.defaultjs||{},o.a.global.defaultjs.extdom=o.a.global.defaultjs.extdom||{VERSION:"1.0.0-beta.1",utils:{Utils:o.a}};const T=new DOMParser;o.a.global.find=function(){return document.find.apply(document,arguments)},o.a.global.ready=function(){return document.ready.apply(document,arguments)},o.a.global.create=function(t,e){if("string"!=typeof arguments[0])throw new Error("The first argument must be a string!");let n=T.parseFromString(arguments[0].trim(),arguments[1]||"text/html"),r=n.body.childNodes,o=document.createDocumentFragment();return o.append(r),o.childNodes};var j=n(0),_=n(1);const A={id:"async",accept:function(t){return!1},execute:function(t){return Promise.resolve(t)}};_.a.addTask(A,j.a.PHASE.INIT);const P={id:"add-attribute",accept:function(t){return t.element.is("[jstl-add-attribute]")},execute:function(t){return Promise.resolve(t)}};_.a.addTask(P,j.a.PHASE.MANIPULATION+200);var w=n(2);const L=w.a.ExpressionResolver,S=function(t,e,n){return L.resolveText(e,n.data).then((function(r){e!=r&&n.element.attr(t,r)}))},O={id:"attribute",accept:function(t){const e=t.element.attr();return void 0!==e&&null!=e&&!t.element.is("[jstl-attribute-ignore]")},execute:function(t){const e=t.element.attr(),n=[];for(const r in e)n.push(S(r,e[r],t));return Promise.all(n).then((function(){return t}))}};_.a.addTask(O,j.a.PHASE.CONTENT+100);const C=w.a.ExpressionResolver,I=function(t,e){if(0==t.length)return!1;const n=t.shift();return C.resolve(n.attr("jstl-when"),e.data,!1).then((function(r){return r?(t.forEach((function(t){t.remove()})),r):(n.remove(),I(t,e))}))},M={id:"choose",accept:function(t){return t.element.is("[jstl-choose]")},execute:function(t){return I(Array.from(t.element.find(":scope > [jstl-when]")),t).then((function(e){e&&t.element.find(":scope > [jstl-otherwise]").remove()})).then((function(){return t}))}};_.a.addTask(M,j.a.PHASE.MANIPULATION+100);n(6);var k=n(3);const H=w.a.ExpressionResolver,D="defaultjs.tl.foreach.template",R="jstl-foreach",V="jstl-foreach-var",F="jstl-foreach-status",U="jstl-foreach-count",$="jstl-foreach-start-index",B="jstl-foreach-step",X="jstl-foreach-break-condition",q=function(t,e,n,r,o){r.element.attr(X);return H.resolve(r.element.attr($),r.data,0).then((function(i){return function(t,e,n,r,o,i,s,a){if(t>=e.length)return a;const l=k.a.merge({},i);return l[r]=e[t],l[o]={index:t,number:t+1,count:e.length,data:e,context:i.data},H.resolve(n,l,!1).then((function(t){return t?a:i.processor.execute(s.cloneNode(!0),l,i.root).then((function(t){return a.push(t.element)}))}))}(i,t,e,n,r,o,[])}))},z=function(t,e,n,r,o){r.element.attr(X);return H.resolve(r.element.attr($),r.data,0).then((function(i){return function(t,e,n,r,o,i,s,a,l){if(t>=n.length)return l;const u=e[t],c=k.a.merge({},s);return c[o]=n[u],c[i]={index:t,number:t+1,key:u,count:n.length,data:n,context:s.data},H.resolve(r,c,!1).then((function(t){return t?l:s.processor.execute(a.cloneNode(!0),c,s.root).then((function(t){return l.push(t.element)}))}))}(i,Object.getOwnPropertyNames(t),t,e,n,r,o,[])}))},G=function(t,e,n,r,o){if(null==t&&void 0!==r.element.attr(U))return function(t,e,n,r){return Promise.all([H.resolve(n.element.attr($)||0,n.data,0),H.resolve(n.element.attr(U)||0,n.data,0),H.resolve(n.element.attr(B)||1,n.data,1)]).then((function(o){let i=[];const s=o[0]||0,a=o[1]||0,l=o[2]||1;for(let u=s;u<a;u+=l){const s=k.a.merge({},n.data);s[t]=u,s[e]={index:u,number:u+1,count:o[1],context:n.data},i.push(_.a.execute(r.cloneNode(!0),s,n.root).then((function(t){return t.element})))}return Promise.all(i)}))}(e,n,r,o);if(null!=expression){let i=H.resolve(t,r,null);return null==i?r:i instanceof Array?q(i,e,n,r,o):i instanceof Object?z(i,e,n,r,o):null}},J={id:"foreach",accept:function(t){return t.element.is("[jstl-foreach]")},execute:function(t){const e=t.element,n=function(t){let e=t.data(D);return void 0===e&&(e=t.content(),t.data(D,e)),e}(t.element);if(void 0!==n){const r=e.attr(R)||null,o=e.attr(V)||"itemVar",i=e.attr(F)||"statusVar";return Promise.resolve(G(r,o,i,t,n)).then((function(t){if(void 0===t)return[];const e=[];return t.forEach((function(t){void 0!==t&&t.forEach((function(t){void 0!==t&&e.push(t)}))})),e})).then((function(n){return e.empty(),null!=n&&e.append(n),t.exit=!0,t})).catch(console.error)}return t}};_.a.addTask(J,j.a.PHASE.MANIPULATION);const Q=w.a.ExpressionResolver,W={id:"if",accept:function(t){return Promise.resolve(t.element.is("[jstl-if]"))},execute:function(t){const e=t.element.attr("jstl-if");return Q.resolve(e,t.data,!1).then((function(e){return e||t.element.remove(),t.exit=!!e,Promise.resolve(t)}))}};_.a.addTask(W,j.a.PHASE.CONDITION);const K=w.a.ExpressionResolver,Y="append",Z="prepend",tt="replace",et={id:"include",accept:function(t){return t.element.is("[jstl-include]")},execute:function(t){const e=t.element.attr("jstl-include-mode")||tt,n=t.element.attr("jstl-include"),r=t.element.attr("jstl-include-options");return Promise.all([K.resolveText(e,t.data),K.resolveText(n,t.data),K.resolve(r,t.data)]).then((function(e){const n=e[0],r=e[1],o=k.a.isPojo(e[2])?e[2]:void 0;return fetch(r,o).then((function(t){return t.text()})).then((function(t){return create(t)})).then((function(e){return _.a.execute(e,t.data,t.root).then((function(){if(n==Y)t.element.append(e);else if(n==Z)t.element.prepend(e);else{if(n!=tt)throw new Error('Include mode "'+n+'" is not supported');t.element.empty(),t.element.append(e)}}))}))})).then((function(){return t.exit=!0,t}))}};_.a.addTask(et,j.a.PHASE.CONTEXT);const nt={formatToHtml:{tabsize:4,tabchar:"&nbsp;",newlineTag:"<br/>"},trimTextLength:{postfix:"..."}},rt={DEFAULTS:nt,trimTextLength:function(t,e,n){if(null==t||"string"!=typeof t||""==t)return t;let r=k.a.merge({},n||{},nt.trimTextLength);if(t.length>e){let n=e-r.postfix.length;if(t.length-n>0)return t.substring(0,n).trim()+r.postfix}return t},formatToHtml:function(t,e){if(null==t||"string"!=typeof t||""==t)return t;let n=k.a.merge({},e||{},nt.formatToHtml),r=t.replace(/\n\r/g,"\n").replace(/\r/g,"\n").split("\n"),o="";for(let t=0;t<r.length;t++)0!=t&&(o+=n.newlineTag),o+=rt.preventTabs(r[t],n.tabsize,n.tabchar);return o},getTabStopMap:function(t,e){let n=[];for(let r=0;r<=t;r++)0==r?n[0]="":n[r]=n[r-1]+e;return n},preventTabs:function(t,e,n){let r=rt.getTabStopMap(e,n),o=e,i="",s=t.split("\t");for(let t=0;t<s.length;t++)if(0!=s[t].length&&0!=t){i=i+r[e-i.length%o]+s[t]}else 0==s[t].length&&0!=t?i+=r[e]:i+=s[t];return i},format:function(t,e){let n=arguments;return t.replace(/{-?[0-9]+}/g,(function(t){let e,r=parseInt(t.substring(1,t.length-1))+1;return r>0&&r<n.length?(e=n[r],"string"!=typeof e&&(e=JSON.stringify(e))):e=-1===r?"{":-2===r?"}":"",e}))}};var ot=rt;const it=w.a.ExpressionResolver,st=function(t){if(t){if(3==t.nodeType){let e=t.textContent;for(;t.nextSibling&&3==t.nextSibling.nodeType;)e+=t.nextSibling.textContent,t.parentNode.removeChild(t.nextSibling);t.textContent=e}else st(t.firstChild);st(t.nextSibling)}},at={html:function(t,e,n){t.replace(create(e))},text:function(t,e,n){let r=e,o=n.element.attr("jstl-text-prevent-format");"string"==typeof o&&0==o.trim().length&&(o="true"),Promise.all([it.resolve(o,n.data,!1),it.resolve(n.element.attr("jstl-text-trim-length")||"0",n.data,0)]).then((function(e){const n=!!e[0],o=e[1];o>0&&(r=ot.trimTextLength(r,o)),n&&(r=ot.formatToHtml(r)),n?t.replace(create(r)):t.textContent=r}))}},lt={id:"text",accept:function(t){return!t.element.is("[jstl-text-ignore]")},execute:function(t){const e=t.element.attr("jstl-text-content-type")||"text";if(void 0===at[e])return;const n=[];return st(t.element),Array.from(t.element.childNodes||[]).filter((function(t){return(3===t.nodeType||4===t.nodeType)&&void 0!==t.textContent&&t.textContent.trim().length>0})).forEach((function(r){let o=r.textContent;o&&n.push(it.resolveText(o,t.data).then((function(n){return at[e](r,n,t)})))})),Promise.all(n).then((function(){return t}))}};_.a.addTask(lt,j.a.PHASE.CONTENT);const ut={id:"children",accept:function(t){const e=t.element.children;return null!=e&&e.length>0},execute:function(t){return _.a.execute(t.element.find(":scope>*"),t.data,t.root)}};_.a.addTask(ut,j.a.PHASE.CHILDREN);j.a,_.a;const ct=window||ct||self||{};ct.defaultjs=ct.defaultjs||{},ct.defaultjs.tl=ct.defaultjs.tl||{VERSION:"1.0.0-beta.1",Constants:j.a,Processor:_.a}}]);